<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <title>Gaagle</title>

</head>

<body>
    <form method="post" th:action="@{/user/update}">
        <input type="hidden" name="userId" th:value="${#authentication.principal.userId}">
        Nickname: <input type="text" name="nickname" th:value="${#authentication.name}">
        <button type="submit">변경</button><br>
        Nickname: <span sec:authentication="name"></span><br>
        Roles: <span sec:authentication="principal.authorities"></span><br>
        Email: <span sec:authentication="principal.attributes['email']"></span><br>
        oAuthProvider: <span sec:authentication="principal.attributes['oAuthProvider']"></span><br>
        createDate: <span sec:authentication="principal.attributes['createDate']"></span><br>
    </form>
    <form method="post" th:action="@{/user/delete}">
        <input type="hidden" name="userId" th:value="${#authentication.principal.userId}">
        <input type="hidden" name="oAuthProvider" th:value="${#authentication.principal.attributes['oAuthProvider']}">
        <button type="submit" onclick="return confirm('정말로 탈퇴 하시겠습니까?')">회원 탈퇴</button>
    </form>

    <div class="input-group mb-3 d-flex justify-content-center">
        <form class="d-flex">
            <div class="input-group" style="width: 500px;">
                <select class="form-select" name="searchType">
                    <option selected>검색 기준 선택</option>
                    <option value="title">제목</option>
                    <option value="content">본문</option>
                </select>
                <input class="form-control" type="search" placeholder="검색어를 입력하세요" aria-label="Search" name="keyword">
                <button class="btn btn-primary" type="submit"><i class="fas fa-search"></i></button>
            </div>
        </form>
    </div>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Writer</th>
                <th>Created Date</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="board : ${response.list}">
                <td th:text="${board.boardId}"></td>
                <td>
                    <a th:text="${board.boardTitle}" th:href="@{/board/list/view(id=${board.boardId})}"></a>
                </td>
                <td th:text="${board.nickName}"></td>
                <td>
                    <th:block th:with="nowDay=${#calendars.format(#calendars.createNow(), 'yyyy-MM-dd')}">
                        <th:block th:if="${nowDay} == ${#dates.format(board.boardCreateDate, 'yyyy-MM-dd')}">
                            <span th:text="${#dates.format(board.boardCreateDate, 'HH:mm')}"></span>
                        </th:block>
                        <th:block th:unless="${nowDay} == ${#dates.format(board.boardCreateDate, 'yyyy-MM-dd')}">
                            <span th:text="${#dates.format(board.boardCreateDate, 'yyyy-MM-dd')}"></span>
                        </th:block>
                    </th:block>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="d-flex justify-content-center">
        <nav>
            <ul class="pagination">
                <li th:class="${pageNum == 1} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="@{/user/info(pageNum=1)}">First</a>
                </li>
                <li th:class="${pageNum == 1} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="@{/user/info(pageNum=${pageNum - 1})}">Previous</a>
                </li>
                <th:block th:each="page : ${#numbers.sequence(response.pagination.startPage, response.pagination.endPage)}">
                    <li th:class="${pageNum == page} ? 'page-item active' : 'page-item'">
                        <a class="page-link" th:href="@{/user/info(pageNum=${page})}" th:text="${page}"></a>
                    </li>
                </th:block>
                <li th:class="${pageNum == response.pagination.pageCount} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="@{/user/info(pageNum=${pageNum + 1})}">Next</a>
                </li>
                <li th:class="${pageNum == response.pagination.pageCount} ? 'page-item disabled' : 'page-item'">
                    <a class="page-link" th:href="@{/user/info(pageNum=${response.pagination.pageCount})}">Last</a>
                </li>
            </ul>
        </nav>
    </div>
    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-DxhJ3qg3Yp7eH8WcEh7vmyGpZtqJMWnA+ZtXLdHwFbiyQJgofE+MzHUIBRcJ5Zpx" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
</body>

</html>